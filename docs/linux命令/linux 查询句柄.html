<attachment contenteditable="false" data-atts="%5B%5D" data-aid=".atts-4d800b33-21a7-45e1-b51b-842e6121e4e9"></attachment><h2><a href="https://www.cnblogs.com/cloudwind2011/p/6409074.html" target="_blank" style="color: rgb(34, 51, 85);">Linux下查看进程打开的文件句柄数</a></h2><p>---查看系统默认的最大文件句柄数，系统默认是1024</p><p><span style="color: rgb(0, 0, 255);"># ulimit -n</span></p><p><span style="color: rgb(0, 0, 255);">1024</span></p><p>&nbsp;</p><p>----查看当前进程打开了多少句柄数</p><p><span style="color: rgb(0, 0, 255);"># lsof -n|awk '{print $2}'|sort|uniq -c|sort -nr|more</span></p><p><span style="color: rgb(0, 0, 255);">131 24204　</span></p><p><span style="color: rgb(0, 0, 255);">57 24244 </span></p><p><span style="color: rgb(0, 0, 255);">57 24231&nbsp;</span><span style="color: rgb(255, 0, 0);">........</span></p><p><span style="color: rgb(255, 0, 0);">其中第一列是打开的句柄数，第二列是进程ID。</span></p><p>可以根据ID号来查看进程名。</p><p><span style="color: rgb(0, 0, 255);"># ps aef|grep 24204</span></p><p><span style="color: rgb(0, 0, 255);">nginx 24204 24162 99 16:15 ? 00:24:25 /usr/local/nginx/sbin/nginx -s</span></p><p><br></p><p><br></p><p><span class="ql-cursor">﻿</span>Linux有<span style="color: rgb(255, 0, 0);">硬性</span>限制和<span style="color: rgb(255, 0, 0);">软性</span>限制。可以通过ulimit来设定这两个参数。方法如下，以root用户运行以下命令：</p><p><span style="color: rgb(255, 0, 0);"># ulimit -HSn 4096</span></p><p>以上命令中，H指定了硬性大小，S指定了软性大小，n表示设定单个进程最大的打开文件句柄数量。个人觉得最好不要超过4096，毕竟打开的文件句柄数越多响应时间肯定会越慢。设定句柄数量后，系统重启后，又会恢复默认值。如果想永久保存下来，可以修改.bash_profile文件，可以修改 /etc/profile 把上面命令加到最后.</p><p><br></p>