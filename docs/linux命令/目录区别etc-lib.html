<attachment contenteditable="false" data-atts="%5B%5D" data-aid=".atts-29a37370-2d25-4682-a4ea-9a6814174ea9"></attachment><h3 class="ql-align-justify">1. 区别</h3><h5 class="ql-align-justify">1.1 [/usr]/lib/systemd/system/ (软件包安装的单元)</h5><p class="ql-align-justify">The expectation is that&nbsp;<code style="background-color: rgb(238, 238, 238); color: rgb(34, 34, 34);">/lib/systemd/system</code>&nbsp;is a directory that should only contain systemd unit files which were put there by the package manager (YUM/DNF/RPM/APT/etc).</p><h5 class="ql-align-justify">1.2 /etc/systemd/system/(系统管理员安装的单元, 优先级更高)</h5><p class="ql-align-justify">Files in&nbsp;<code style="background-color: rgb(238, 238, 238); color: rgb(34, 34, 34);">/etc/systemd/system</code>&nbsp;are manually placed here by the operator of the system for ad-hoc software installations that are not in the form of a package. This would include tarball type software installations or home grown scripts.</p><h3 class="ql-align-justify">2. 优先级</h3><pre class="ql-syntax ql-align-justify" spellcheck="false">systemd的使用大幅提高了系统服务的运行效率, 而unit的文件位置一般主要有三个目录：
Table 1.  Load path when running in system mode (--system).
┌────────────────────────┬─────────────────────────────┐
│Path                    │ Description                 │
├────────────────────────┼─────────────────────────────┤
│/etc/systemd/system     │ Local configuration         │
├────────────────────────┼─────────────────────────────┤
│/run/systemd/system     │ Runtime units               │
├────────────────────────┼─────────────────────────────┤
│/lib/systemd/system     │ Units of installed packages │
└────────────────────────┴─────────────────────────────┘
</pre><p class="ql-align-justify">这三个目录的配置文件优先级依次从高到低，如果同一选项三个地方都配置了，优先级高的会覆盖优先级低的。</p><p class="ql-align-justify">系统安装时，默认会将unit文件放在<code style="background-color: rgb(238, 238, 238); color: rgb(34, 34, 34);">/lib/systemd/system</code>目录。如果我们想要修改系统默认的配置，比如<code style="background-color: rgb(238, 238, 238); color: rgb(34, 34, 34);">nginx.service</code>，一般有两种方法：</p><ol><li class="ql-align-justify">在<code style="background-color: rgb(238, 238, 238); color: rgb(34, 34, 34);">/etc/systemd/system</code>目录下创建<code style="background-color: rgb(238, 238, 238); color: rgb(34, 34, 34);">nginx.service</code>文件，里面写上我们自己的配置。</li><li class="ql-align-justify">在<code style="background-color: rgb(238, 238, 238); color: rgb(34, 34, 34);">/etc/systemd/system</code>下面创建<code style="background-color: rgb(238, 238, 238); color: rgb(34, 34, 34);">nginx.service.d</code>目录，在这个目录里面新建任何以.conf结尾的文件，然后写入我们自己的配置。推荐这种做法。</li></ol><p class="ql-align-justify"><code style="background-color: rgb(238, 238, 238); color: rgb(34, 34, 34);">/run/systemd/system</code>这个目录一般是进程在运行时动态创建unit文件的目录，一般很少修改，除非是修改程序运行时的一些参数时，即Session级别的，才在这里做修改。</p><p><br></p>