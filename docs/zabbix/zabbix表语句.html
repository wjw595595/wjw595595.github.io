<attachment contenteditable="false" data-atts="%5B%5D" data-aid=".atts-4349dbda-764b-4437-bdc7-85d4f9c52120"></attachment><p>CALL month_report();</p><p><br></p><p>(select hosts.hostid,hosts.host,hosts.name,items.itemid,items.name,items.key_,items.port,items.status</p><p>from items left join hosts</p><p>on items.hostid=hosts.hostid where hosts.`status`=0 and items.`status`=0 and items.`flags` in(0,4));</p><p>-- 查询主机(hosts.`status`=0,0:已监控的主机，1是未监控，3是模板) --已监控的(items.`status`=0 打开：1是关闭)&nbsp;--flage(0:普通监控项，4：自动发现监控项)</p><p><br></p><p><br></p><p>select triggers.triggerid,functions.itemid,triggers.description,triggers.priority,triggers.`flags`</p><p>from triggers left join functions</p><p>on triggers.triggerid=functions.triggerid where triggers.`flags`&nbsp;in(0,4) and triggers.`status`=0 and triggers.`value`=0;</p><p><br></p><p>select&nbsp;triggers.triggerid,functions.itemid,triggers.description,triggers.priority,triggers.`flags`</p><p>from triggers left join functions</p><p>on triggers.triggerid=functions.triggerid where triggers.`flags`&nbsp;in(0,4) and triggers.`status`&nbsp;in(0);</p><p><br></p><p>-- 查询主机triggers.`flags` not in(0,4)，0是普通触发器，4：自动发现触发器&nbsp;triggers.`status`:0,启用，1禁用&nbsp;: triggers.value：0 - (default 默认) OK; 正常；1 - problem. 故障。</p><p>--</p><p><br></p><p>select * from events where events.source=0 and events.object=0 and events.value=1 and events.`eventid`='36';</p><p><br></p><p><br></p><p>select COUNT(*),eventid from events group by eventid having COUNT(eventid)=1;</p><p>-- source:0 - 由触发器创建的事件; 1 - 由发现规则创建的事件; 2 - 活动代理自动注册的事件; 3 - 内部事件.</p><p>-- object:0 触发器对象类型&nbsp;</p><p>-- value：0正常，1异常</p><p>--a.time BETWEEN 1542902400 AND 1542988799</p><p>select * from items a where a.`flags`&lt;&gt;0;</p><p><br></p><p><br></p><p>--</p><p><br></p><p>SELECT a.count,b.bname,DATE_FORMAT(FROM_UNIXTIME(a.time),'%Y-%m-%d %H:%i:%s') as time,c.age</p><p>from&nbsp;a LEFT JOIN b ON a.ruleid = b.id&nbsp;</p><p>LEFT JOIN c ON a.topruleid = c.id</p><p>WHERE a.time BETWEEN 1542902400 AND 1542988799 AND a.sid = 624&nbsp;</p><p><br></p>