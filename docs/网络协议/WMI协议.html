<attachment contenteditable="false" data-atts="%5B%5D" data-aid=".atts-343bc40b-6262-4eda-a062-668dd55d2cf3"></attachment><p><span style="color: rgb(0, 0, 0);">以下内容，你几乎都可以通过google 百度很容易搜到，在此稍微做流水账整理了下。</span></p><p><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;读者在项目（</span><strong style="color: rgb(0, 0, 0);">多半是监控</strong><span style="color: rgb(0, 0, 0);">）中若需用到WMI，还需要深入survey 的~</span></p><p><strong style="color: rgb(0, 0, 0);">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</strong></p><p><strong style="color: rgb(0, 0, 0);">第一部分，介绍WMI</strong></p><p><strong style="color: rgb(0, 0, 0);">WMI是什么？</strong></p><p><span style="color: rgb(0, 0, 0);">WMI(Windows Management Instrumentation ,Windows 管理规范 )是Windows 2K/XP管理系统的核心；</span></p><p><span style="color: rgb(0, 0, 0);">WMI是以CIMOM为基础，CIMOM即公共信息模型对象管理器</span></p><p><span style="color: rgb(0, 0, 0);">（Common Information Model Object Manager），</span></p><p><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;CIMOM是一个描述操作系统构成单元的对象数据库，为MMC和脚本程序提供了一个访问操作系统构成单元的公共接口。</span></p><p><span style="color: rgb(0, 0, 0);">WMI是Microsoft扩展CIM 2.0得到的面向Win32系统的扩展模型 ，用其可以访问及其高效地管理Windows资源</span></p><p><strong style="color: rgb(0, 0, 0);">WMI的组成？</strong></p><p><span style="color: rgb(0, 0, 0);">严格说来，WMI由四部分组成：</span></p><p><span style="color: rgb(0, 0, 0);">1、&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;公共信息模型对象管理器——CIMOM</span></p><p><span style="color: rgb(0, 0, 0);">2、&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;公共信息模型——CIM</span></p><p><span style="color: rgb(0, 0, 0);">3、&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WMI提供程序</span></p><p><span style="color: rgb(0, 0, 0);">4、&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WMI脚本对象库</span></p><p><span style="color: rgb(0, 0, 0);">其中其第1、2、3三个部分，在使用中很少加以区别，我们一般统称为CIM库。</span></p><p><span style="color: rgb(0, 0, 0);">用WMI脚本对象库访问cim库。</span></p><p><span style="color: rgb(0, 0, 0);">本质：是一个带很多分支的树状数据库，是一项服务！</span></p><p><strong style="color: rgb(0, 0, 0);">WMI能做什么？</strong></p><p><span style="color: rgb(0, 0, 0);">利用WMI可以高效地管理远程和本地的计算机.WMI是WBEM模型的一种实现。</span></p><p><span style="color: rgb(0, 0, 0);">WBEM模型最关键的部分是它的数据模型（或描述和定义对象的方式）、编码规范（Encoding Specification），以及在客户端和服务器端之间传输数据的模式。</span></p><p><span style="color: rgb(0, 0, 0);">CIM即WBEM的数据模型！</span></p><p><span style="color: rgb(0, 0, 0);">CIM是一个用来命名计算机的物理和逻辑单元的标准的命名系统（或称为命名模式），例如硬盘的逻辑分区、正在运行的应用的一个实例，或者一条电缆。</span></p><p><span style="color: rgb(0, 0, 0);">WBEM模型：基于web的企业管理，为管理企业环境开发一套标准接口集。</span></p><p><span style="color: rgb(0, 0, 0);">WMI作为一种规范和基础结构，通过它可以访问、配置、管理和监视几乎所有的Windows资源，比如用户可以在远程计算机器上启动一个进程；设定一个在特定日期和时间运行的进程；远程启动计算机；获得本地或远程计算机的已安装程序列表；查询本地或远程计算机的Windows事件日志等等。</span></p><p><span style="color: rgb(0, 0, 0);">WMI通过提供一致的模型和框架，所有的 Windows 资源均被描述并公开给外界。最好的一点是，系统管理员可以使用 WMI 脚本库创建系统管理脚本，从而管理任何通过 WMI 公开的 Windows 资源！</span></p><p><span style="color: rgb(0, 0, 0);">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></p><p><strong style="color: rgb(51, 51, 51);">第二部分：利用WMI管理远程PC</strong></p><p><strong style="color: rgb(0, 0, 0);">通信机制</strong></p><p><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;WMI远程连接是以 DCOM 作为基础远程通信机制。所以WMI 远程连接必须先满足 DCOM 对模拟和身份验证的安全要求。</span></p><p><span style="color: rgb(0, 0, 0);">好吧，又不得不扯到DCOM：</span></p><p><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;DCOM（分布式组件对象模型,分布式组件对象模式）是一系列微软的概念和程序接口，利用这个接口，客户端程序对象能够请求来自网络中另一台计算机上的服务器程序对象。DCOM基于组件对象模型（COM），COM提供了一套允许同一台计算机上的客户端和服务器之间进行通信的接口（运行在Windows95或者其后的版本上）。</span></p><p><span style="color: rgb(0, 0, 0);">好吧，这个介绍似乎也帮不了多少忙，作者水平有限，用几句话也概括不了。身份验证安全级别嘛，估计就是配置一堆东西，然后就ok了。反正用DCOM这个东东，2台计算机就可以相互通信。至于它怎么做到的，我们看看它采用的协议。</span></p><p><strong style="color: rgb(0, 0, 0);">通信协议RPC</strong></p><p><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;远程连接会涉及到客户端和服务器端间的通信，通信就涉及到协议，DCOM底层使用了RPC协议（当然也可以使用其他协议，http+tcp）</span></p><p><strong style="color: rgb(0, 0, 0);"><em>【</em>RPC协议在以后的学习过程中还会经常碰到，事实上Java RMI差不多就是RPC的java实现<em>】</em></strong></p><p><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;Remote Procedure Call (RPC)是视窗系统操作系统使用的一种远程过程调用协议，RPC提供进程间交互通信机制，允许在某台计算机上运行程式的无缝地（代码一样）在远程系统上执行代码。协议本身源自开放软件基金会的RPC协议，Microsoft在其基础上增加了自己的一些扩展。</span></p><p><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;RPC是分布式计算的C/S的例子。远程过程调用总是由客户端对服务器发出一个执行若干过程请求，并用客户端提供的参数。执行结果将返回给客户端。</span></p><p><span style="color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;RPC 协议假定某些传输协议的存在，如 TCP 或 UDP，为通信程序之间携带信息数据。在 OSI 网络通信模型中，RPC 跨越了传输层和应用层。</span></p><p><strong style="color: rgb(0, 0, 0);">注意事项</strong></p><p><span style="color: rgb(0, 0, 0);">当通过WMI模式监控Windows机器时</span></p><p><span style="color: rgb(0, 0, 0);">以下服务应该在远程Windows机器运行：</span></p><p><span style="color: rgb(0, 0, 0);">1) Remote Procedure Call (RPC)远程过程调用 -- 端口: 135</span></p><p><span style="color: rgb(0, 0, 0);">2) Windows Management Instrumentation (WMI) Windows管理规范-- 端口: 445</span></p><p><span style="color: rgb(0, 0, 0);">如果启用防火墙，应在防火墙开放这些端口。</span></p><p><span style="color: rgb(0, 0, 0);">135端口似乎也是黑客喜欢攻击的端口之一呢~~&nbsp;</span></p><p><br></p><p><br></p><p><br></p><p><br></p><h3>J-Interop</h3><p><span style="color: rgb(77, 77, 77);">JAVA 调用 WMI的好库，包括&nbsp;</span><a href="http://www.j-interop.org/index.html" target="_blank" style="color: rgb(30, 91, 119);">J-Interop</a><span style="color: rgb(77, 77, 77);">、</span><a href="http://sourceforge.net/projects/jacob-project/" target="_blank" style="color: rgb(30, 91, 119);">JACOB-Project</a><span style="color: rgb(77, 77, 77);">&nbsp;和&nbsp;</span><a href="http://j-integra.intrinsyc.com/products/com/" target="_blank" style="color: rgb(30, 91, 119);">J-Integra</a><span style="color: rgb(77, 77, 77);">。其中，我更喜欢J-Interop，因为它是完全免费和开源的API</span></p><p><br></p><p><br></p><h1>wmi4j</h1><p><br></p><p><span style="color: rgb(77, 77, 77);">wmi4j是纯Java实现的Windows WMI客户端，它基于j-interop针对WMI重新封装，提供了更便捷的方法，能满足基本的windows管理，包括服务管理，性能查询，执行脚本等等。</span></p><p><br></p><p><a href="https://blog.51cto.com/leaze/1559263" target="_blank">https://blog.51cto.com/leaze/1559263</a></p><p>windows接口 <a href="https://www.cnblogs.com/guorongtao/p/11636007.html" target="_blank">https://www.cnblogs.com/guorongtao/p/11636007.html</a></p><p><br></p>